\documentclass[12pt,a4paper]{article}
\usepackage{cite}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{url}
\usepackage{stfloats}
\usepackage{array}
\usepackage{tabularx}
\usepackage{amsmath}
\usepackage{textcomp}
\usepackage[english]{babel}
\usepackage{latexsym}
\usepackage{caption}
\usepackage{hyperref}
\usepackage{siunitx}
\usepackage{listings}
\setlength{\extrarowheight}{3pt}
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{environ}
\usepackage{authblk}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\pgfplotsset{compat=1.11}
\usepackage{listings}
\usepackage{color} %red, green, blue, yellow, cyan, magenta, black, white
\definecolor{mygreen}{RGB}{28,172,0} % color values Red, Green, Blue
\definecolor{mylilas}{RGB}{170,55,241}
\definecolor{mygray}{RGB}{0.5, 0.5, 0.5}

\newlength\figureheight 
\newlength\figurewidth 
\setlength\figureheight{6cm} 
\setlength\figurewidth{0.8 \textwidth}
\lstset{language=Matlab,%
    %basicstyle=\color{red},
		basicstyle=\scriptsize,
    breaklines=true,%
    morekeywords={matlab2tikz},
    frame=single,%
	numbers=left,%
	numberstyle=\tiny\color{mygray},%
    keywordstyle=\color{blue},%
    morekeywords=[2]{1}, keywordstyle=[2]{\color{black}},
    identifierstyle=\color{black},%
    stringstyle=\color{mylilas},
    commentstyle=\color{mygreen},%
    showstringspaces=false,%without this there will be a symbol in the places where there is a space
    %numbers=left,%
    %numberstyle={\tiny \color{black}},% size of the numbers
    numbersep=9pt, % this defines how far the numbers are from the text
    emph=[1]{for,end,break},emphstyle=[1]\color{red}, %some words to emphasise
    %emph=[2]{word1,word2}, emphstyle=[2]{style},    
}
	\title{\textbf{\texttt{Matlab}$^\text{{\fontsize{12}{1em}\textcopyright}}$ Exercise II: Active Noise Control with an FIR filter}}
	\author[$\dagger$]{Ruben \textsc{Biesheuvel}}
	\author[$\ddagger$]{Mars \textsc{Geuze}}
	\affil[$\dagger$]{Student number 4076680}
	\affil[$\ddagger$]{Student number 4109139}
	\renewcommand\Authands{ and }


\begin{document}

	\maketitle

\section*{Question 1}
\subsection*{Question 1.1}
\subsection*{Question 1.2}
\label{code1}
\lstinputlisting{m/Exercise_1.m}
\begin{table}[h!]
\centering
\caption{Output coefficients $w(j)$ for the optimal FIR Wiener filter}
\begin{tabular}{l r r r r}
\hline
 & \multicolumn{4}{c}{Filter order $m$}\\
 \cline{2-5}
Coefficient $w(j)$ & \num{1} & \num{2} & \num{4} & \num{6} \\
\hline
$w(0)$ & \num{0.7759} & \num{0.9209}& \num{0.9935} & \num{0.9995} \\
$w(1)$ & \num{0} & \num{-0.1623}& \num{0.0327}& \num{0.0487} \\
$w(2)$ & \num{0}& \num{0}& \num{-0.0765}& \num{-0.0242}\\
$w(3)$ & \num{0}& \num{0}& \num{-0.2255}& \num{-0.0514}\\
$w(4)$ & \num{0}& \num{0}& \num{0}& \num{-0.0859}\\
$w(5)$ & \num{0}& \num{0}& \num{0}& \num{-0.1916}\\
\hline
\end{tabular}
\end{table}

\clearpage\section*{Question 2}

\begin{table}[h!]
\centering
\caption{Standard deviation $\sigma_{W}$ between the sound $d(n)$ and the estimated sound $x(n) - \hat{v_{1}}(n)$}
\begin{tabular}{l | r}
Filter order $m$ & $\sigma_{W}$ \\
\hline
\num{1} & \num{0.2075}\\
\num{2} & \num{0.1996}\\
\num{4} & \num{0.1674}\\
\num{6} & \num{0.1362}\\
\hline
\end{tabular}
\end{table}

\begin{figure}[h!]
\centering
\input{m/Exercise_2.tex}
\caption{Subplot 1 shows the original sound and the noise corrupted signal. Subplot 2 shows the original sound and the filtered sound with optimal Wiener filter $W(z)$ of order \num{6}}
\end{figure}

\clearpage\section*{Question 3}
\lstinputlisting{m/Exercise_3.m}
\begin{table}[h!]
\centering
\caption{Output coefficients $w(j)$ for the estimated FIR Wiener filter}
\begin{tabular}{l r r r r}
\hline
 & \multicolumn{4}{c}{Filter order $m$}\\
 \cline{2-5}
Coefficient $w(j)$ & \num{1} & \num{2} & \num{4} & \num{6} \\
\hline
$w(0)$ & \num{0.7679} & \num{0.9200}& \num{0.9960} & \num{0.9995} \\
$w(1)$ & \num{0} & \num{-0.1689}& \num{0.0339}& \num{0.0513} \\
$w(2)$ & \num{0}& \num{0}& \num{-0.0783}& \num{-0.0243}\\
$w(3)$ & \num{0}& \num{0}& \num{-0.2342}& \num{-0.0548}\\
$w(4)$ & \num{0}& \num{0}& \num{0}& \num{-0.0885}\\
$w(5)$ & \num{0}& \num{0}& \num{0}& \num{-0.1956}\\
\hline
\end{tabular}
\end{table}

\begin{table}[h!]
\centering
\caption{Standard deviation $\sigma_{w}$ between the sound $d(n)$ and the estimated sound $x(n) - \hat{v_{1}}(n)$}
\begin{tabular}{l | r}
Filter order $m$ & $\sigma_{w}$ \\
\hline
\num{1} & \num{0.2177}\\
\num{2} & \num{0.2089}\\
\num{4} & \num{0.1750}\\
\num{6} & \num{0.1423}\\
\hline
\end{tabular}
\end{table}

\begin{figure}[h!]
\centering
\input{m/Exercise_3.tex}
\caption{Subplot 1 shows the original sound and the noise corrupted signal. Subplot 2 shows the original sound and the filtered sound with estimated Wiener filter $w(z)$ of order \num{6}}
\end{figure}

\end{document}
